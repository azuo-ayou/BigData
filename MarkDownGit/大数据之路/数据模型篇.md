

datawork全局了解：https://help.aliyun.com/document_detail/73016.html

datawork使用手册：https://dataworks-doc.yuque.com/datamodel/ngd5zk/tmpomo

### 什么事维度建模

维度建模是一种将大量数据结构化的逻辑设计手段，包含维度和指标，它不像ER模型目的是消除冗余数据，维度建模是面向分析，最终目的是提高查询性能，所以会增加数据冗余，并且违反三范式。

## 1.1为什么需要数据建模？

​		随着互联网时代的发展，数据爆发式增长，如何将这些数据进行有序、有结构地分类组织和存储是我们面临的一个挑战。

​		**数据模型就是数据组织和存储方法**，他强调从业务、数据存取和使用角度合理存储数据。Linux 的创始人 Torvalds 有 一段关于“什么才是优秀程序员”的话:“烂程序员关心的是代码，好程序员关心的是数据 结构和它 们之间的关系”。有了合适业务和基础数据存储环境的模型，那么大数据就能获得以下好处。

- 性能：快速查询，减少io

- 成本：减少冗余、提高复用性
- 效率：良好的数据模型能极大地改善用户使用数据的体验，提高 使用数据的效率
- 质量：改善口径的不一致性，减少数据计算错误的可能性

因此，毋庸置疑，大数据系统需要数据模型方法来帮助更好地组织 和存储数据，以便在性能、成本、效率和质量之间取得最佳平衡。





## 1.2 关系数据库系统和数据仓库

​		大量的数据仓库系统依 托强大的关系数据库能力存储和 处理数据，其采用的数据模型方法也是基于关系数据库理论的。仍然在大规模使用 SQL 进行数据的加工和 处理，仍然在用 Table存储数据，仍然在使用关系理论描述数据之间的 关系 ，**只是在大数据领域，基于其数据存取的特点在关系数据模型的范 式上有了不同 的选择而已**。



数据湖、数据仓库、数据集市、数据中台的区别https://zhuanlan.zhihu.com/p/189640832

- 数据仓库：面向企业/部门级别的数据建设，多主题，通常存储的是结构化、规范高度一致性的数据
- 数据集市：更多的是面向单一主体的数据，更关心局部的数据，对于业务人员来说，数据集市通常是更近的
- 数据湖：未经加工的原始数据，结构化、非结构化数据都有
- 数据中台：指的是一套数据应用和工具，包括分布式ETL、数据资产管理、数据标签管理、数据沙箱、自助分析平台、元数据管理、数据质量管理等等，底层则已现有的数仓、大数据平台等为数据源，为企业提供数据资产管理的能力，并持续挖掘数据价值，持续提供数据智能服务。



## 1.3 从OLTP和OLAP系统的区别看模型方法的选择

- OLTP：面向的主要数据操作是随机读写，主要采用3NF的实体关系模型，从而解决事务处理中数据的冗余和一致性
- OLAP：面向的主要数据操作是批量读写，事物处理的一致性不是OLAP主要关注的，他主要关注的是数据的整合，以及在一次性的复杂大数据查询和处理中的性能

因此他们需要采用一些不同的数据建模方法





## 1.4 经典的数据仓库建模方法论







### 指标命名的规范：

1. 指标体系



### 建模的顺序

1、数据业务调研，数据需求分析，这一步是重中之中，直觉决定了数仓建设的是否成功

2、业务过程和维度的抽象

3、基于报表和业务调研的 总线矩阵构建

4、使用dataworks工具，定义指标 和 维度 以及表命名体系

5、sql代码层面的维护与实现

6、文档补充



### 原则

1. 高内聚地耦合
2. 数据一致性：在不同的表，相同字段应该是一样的
3. 公共逻辑下沉
4. 命名清晰
5. 可回滚
6. 成本和效率的均衡
7. 命名清晰易于理解





1. 维度感念
2. 维度设计
3. 维度的层次
4. 维度规范和反规范
5. 维度的一致性





### 维度的基本概念

维度设计

维度是维度建模的基础和灵魂。在维度建模中，将度量称为“事实” ， 将环境描述为“维度”，维度是用于分析事实所需要的多样环境。例如， 在分析交易过程时，可以通过买家、卖家、商品和时间等维度描述交易 发生的环境。

维度的设计过程就是确定维度属性的过程，如何生成维度属性，以 及所生成的维度属性的优劣，决定了维度使用的方便性，成为数据仓库 易用性的关键。正如 Kimball 所说的，数据仓库的能力直接与维度属性 的质量和深度成正比。.



确定主维表 和 确定相关维表

### 有歧义点

区分数值型属性和事实

数值型宇段是作为事实还是维度属性，可以参考字段的一般用途。 如果通常用于查询约束条件或分组统计，则是作为维度属性;如果通常 用于参与度量的计算， 则是作为事实。比如商品价格，可以用于查询约 束条件或统计价格区间 的商品数量，此时是作为维度属性使用的;也可 以用于统计某类目 下商品的平均价格，此时是作为事实使用的。另外， 如果数值型字段是离散值，则作为维度属性存在的可能性较大;如果数 值型宇段是连续值 ，则作为度量存在的可能性较大，但并不绝对，需要 同时参考宇段的具体用途。





实时表设计原则：

1. 尽可能包含所有与业务过程相关的事实
2. 只选择与业务过程相关的事实
3. 分解不可加性事实为可加的组件
4. 在选择维度和事实之前必须先声明粒度
5. 在同一个事实表中不能有多种不同粒度的事实
6. 事实的单位要保持一致
7. 对事实的 null值要处理
8. 使用退化维度提高事实表的易用性



实时表

第一步 : 选择业务过程及确定事实表类型。

第二步:声明粒度。

第三步 : 确定维度 。

第四步 . 确定事实 。

第五步 . 冗余维度 。



聚集的基本步骤

第一 步:确定聚集维度。

第二步:确定一致性上钻。

第三步:确定聚集事实。
